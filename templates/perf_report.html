{% extends "layout.html" %}

{% block title %}Performance Analysis Report{% endblock %}

{% block content %}
<div class="container-fluid mt-4">
    <div class="row">
        <div class="col-lg-12">
            <div class="card">
                <div class="card-header">
                    <h3>Performance Analysis for: <code>{{ command }}</code></h3>
                </div>
                <div class="card-body">
                    <a href="{{ url_for('perf_index') }}" class="btn btn-secondary mb-3">Run New Analysis</a>
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-4">
        <!-- Flame Graph Column -->
        <div class="col-lg-12">
            <div class="card">
                <div class="card-header">
                    <h4>Flame Graph</h4>
                </div>
                <div class="card-body" style="padding: 0;">
                    <!-- Embed the SVG directly -->
                    <div class="flamegraph-container" style="width: 100%; overflow-x: auto;">
                        {{ flamegraph_svg|safe }}
                    </div>
                </div>
                <div class="card-footer text-muted">
                    Click on the rectangles to zoom in on a specific part of the call stack.
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-4">
        <!-- AI Analysis Column -->
        <div class="col-lg-12">
            <div class="card">
                <div class="card-header">
                    <h4>AI-Powered Analysis</h4>
                </div>
                <div class="card-body">
                    <div class="markdown-content">
                        {{ llm_analysis_html|safe }}
                    </div>
                </div>
                 <div class="card-footer text-muted">
                    Analysis generated by an AI model. Please verify the suggestions before implementation.
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
